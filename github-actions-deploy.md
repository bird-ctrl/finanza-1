# GitHub Pages Deployment with Environment Variables

## Complete GitHub Actions Workflow for Static Site with API Keys

### 1. GitHub Actions Workflow File (`.github/workflows/deploy.yml`)

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Build with environment variables
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          # Add other environment variables as needed
        run: |
          # Create a config file with the API key for client-side use
          echo "window.CONFIG = { GEMINI_API_KEY: '${{ secrets.GEMINI_API_KEY }}' };" > config.js
          # If using a build process, run it here
          # npm run build

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: '.'

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

### 2. Setting up GitHub Repository Secrets

1. **Navigate to Repository Settings:**
   - Go to your GitHub repository
   - Click on "Settings" tab
   - In the left sidebar, click "Secrets and variables" → "Actions"

2. **Add Repository Secret:**
   - Click "New repository secret"
   - Name: `GEMINI_API_KEY`
   - Value: Your actual Gemini API key
   - Click "Add secret"

### 3. Client-Side JavaScript Configuration

**Option A: Using Generated Config File**
```javascript
// config.js (generated by GitHub Actions)
window.CONFIG = {
  GEMINI_API_KEY: 'your-api-key-here'
};

// main.js - Your application code
const API_KEY = window.CONFIG.GEMINI_API_KEY;

async function callGeminiAPI(prompt) {
  try {
    const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-goog-api-key': API_KEY
      },
      body: JSON.stringify({
        contents: [{
          parts: [{
            text: prompt
          }]
        }]
      })
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Gemini API Error:', error);
    throw error;
  }
}
```

**Option B: Environment Variable Replacement**
```javascript
// For build tools that support environment variable replacement
const API_KEY = process.env.GEMINI_API_KEY || 'fallback-key';
```

### 4. HTML Structure

**index.html**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finanzas AI Finance Coach</title>
</head>
<body>
    <!-- Load configuration first -->
    <script src="config.js"></script>
    <!-- Then load your application -->
    <script src="main.js"></script>
</body>
</html>
```

### 5. Alternative: Using GitHub Actions Variables (Non-Secret)

For non-sensitive configuration:

1. Go to Settings → Secrets and variables → Actions
2. Click "Variables" tab
3. Click "New repository variable"
4. Reference in workflow: `${{ vars.VARIABLE_NAME }}`

### 6. Debugging Your Deployment

**Check GitHub Actions Logs:**
1. Go to "Actions" tab in your repository
2. Click on the latest workflow run
3. Expand each step to see detailed logs
4. Look for error messages during build or deployment

**Check Browser Console:**
1. Open your GitHub Pages site
2. Press F12 to open Developer Tools
3. Check Console tab for JavaScript errors
4. Check Network tab for failed API requests

### 7. Security Considerations

- ⚠️ **Warning**: API keys stored in client-side code are visible to users
- Consider using a backend proxy for sensitive API calls
- Implement rate limiting on your API usage
- Monitor your API key usage in Google AI Studio

### 8. Troubleshooting Common Issues

**"Something went wrong" errors:**
1. Check browser console for specific error messages
2. Verify API key is correctly injected
3. Check network requests for HTTP status codes
4. Try different Gemini models (e.g., gemini-1.5-flash vs gemini-1.5-pro)

**GitHub Actions failures:**
1. Check that secrets are properly set
2. Verify workflow syntax
3. Ensure proper permissions are set
4. Check for typos in secret names